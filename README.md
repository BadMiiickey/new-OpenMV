本文将对目前OpenMV的控制代码进行简单的介绍。

一、 OpenMV官方封装库及其从属类、方法、属性
    官方文档地址: https://docs.singtown.com/micropython/zh/latest/openmvcam/index.html

    1. image
        首先，image的类型是Image，在sensor库(Image类从属于sensor库)下封装使用了大量对于OpenMV检测到的图像的分析方法。
        鉴于实际需求，目前仅使用了以下几种方法。

        (1) draw_rectangle
            作用是在目标位置渲染一个矩形框，可以自定义颜色，大小，位置等。
        (2) draw_string
            作用是在目标位置渲染文本，可以自定义文本内容，位置等。
        (3) get_statistics
            作用是获取当前图像的各类统计数据，从属方法或属性请自行翻阅官方文档。
        
    2. blob
        blob是一个数组，内部元素代表了这个像素的不同参数。
        实际上，blob有易于阅读的获取这些数据的方法，但是目前VSCode并不支持补全，因此笔者重写了一个工具类以增强代码的可读性。

    3. sensor
        sensor库是OpenMV算法开发的核心库(大概)，很多关于识别到的图像处理方法都被封装在这个库下。
        具体方法和属性的介绍请移步官方文档，这对你的开发很有帮助。

二、 自定义的工具类
    为了增强代码规范性与可读性，笔者封装了大量工具类以便VSCode给出对应方法的补全提示，增强开发体验。
    那么为什么是工具类而非实体类呢？
    原因在于OpenMV是一个简单的硬件系统，控制部分也较为简单，没有涉及大量同种的控制元素，因此无需实例化，所有的变量和方法都作为类变量和类方法进行调用即可。

三、 与STM32的通信协议
    目前定义UART3作为OpenMV与STM32的通信串口。
    OpenMV是输出端，write发送的string格式为'a ** b ** c'，字母之间传输的是对应推进器占空比的10000倍(保留三位有效数字)。

四、 与STP23(激光传感器)的通信协议
    目前定义UART1作为OpenMV与STP23的通信串口。
    OpenMV是输入端，any和readFrame组合获取到的是一帧STP23传输的数据，后续通过getClosestDistance得到这一帧数据解析后的距离信息与目前最近距离的最小值。
    具体数据解析被封装在readFrame方法中。

五、未来开发提示
    以下是笔者的一点小想法~

    1. 开发体验部分
        如果你在使用非OpenMV IDE编辑器开发(官方编辑器实在太丑了)，对于OpenMV官方封装的许多库是没有办法正常给出补全提示的。那么有没有办法可以实现补全呢？答案是有的。

        (1) 使用VSCode插件
            味大无需多盐。
            (但是会拖慢VSCode的加载，至少我没用)
        (2) 使用pyi手动进行类型注释
            在某个文件夹下创建一个.pyi文件，在内部创建一个你要进行类型注释的类(例如Image)，采用@staticmethod注释和...手动将Image类下的所有方法重写为类似接口的形式，随后在你需要的地方导入该class，即可使用类型提示。
            至于为什么不使用functools的@dataclass，是因为OpenMV官方没有适配这个库(悲)。
            (不要问笔者为什么不做，问就是懒)
    
    2. 算法优化部分
        (1) 识别强化
            目前识别泳圈依赖于深度学习，后续开发可以考虑从算法层面强化目标的识别率和准确率。
        (2) 双阈值状态机
            目前识别能力有待加强，可以考虑使用双阈值状态机提高灵活性和准确性。
            具体方法是，先采用一个低置信度作为搜索模式，搜索到之后采用更高置信度准确识别。

    3. 硬件拓展部分
        目前OpenMV作为识别模块，STM32作为控制模块，OpenMV有一块洞洞板可供拓展。实际上的拓展性是非常高的。
        调试方面可以做蓝牙或者WiFi传输。


六、
公: 1. 接openmv vin
    2. 接面包板 5v降3.3v
    3. 接激光传感器5v
    4. 
黑: 面包板负极
        
        